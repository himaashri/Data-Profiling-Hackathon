Your task is to generate a Python function to process an anomalies dataset.

The function should:

Accept an anomalies dataset in CSV format as input.
Apply pre-defined validation rules directly derived from a list of instructions in a file named sample-inst.txt.
The col-desc.txt file contains descriptions for each field present in the anomalies dataset and is provided for a functional understanding, but should not directly influence the function code.

Requirements:

The function should be well-documented with docstrings explaining the purpose and logic of each step.
The validation rules should be pre-coded within the function based on the information provided in sample-inst.txt.
The validation rules once applied on the provided anomalies dataset. And each record once processed, should be updated with all the validation message(s).

Please generate the Python function according to the guidelines above.
do not give any comments. I want only code.

Below are the details of the input files:
Instructions file: sample-inst.txt
Instructions

IdentifierType – Must be one of: "CUSIP", "ISIN", "SEDOL", or "Internal".

IdentifierValue – Provide a valid CUSIP, ISIN, SEDOL, or an internal identifier.

AmortizedCost_USDEquivalent – Report as a rounded whole dollar amount.

MarketValue_USDEquivalent – Report as a rounded whole dollar amount.

AccountingIntent – Must be one of: "AFS" (Available-for-Sale), "HTM" (Held-to-Maturity), or "EQ" (Equity Security).

TypeOfHedge – Use "1" for Fair Value Hedge or "2" for Cash Flow Hedge.

HedgedRisk – Use one of the following: "1" for Overall Change in Fair Value or Variability in Cash Flows, "2" for Interest Rate Risk, "3" for Foreign Exchange Risk, "4" for Credit Risk, etc.

HedgeInterestRate – Use "1" for US Treasury, "2" for LIBOR, "3" for Fed Funds, "4" for Other, or "5" for Not Applicable.

HedgePercentage – Provide a decimal value up to four places (e.g., 0.8756).

HedgeHorizon – Report in yyyy-mm-dd format.

HedgedCashFlow – Use "1" for Principal & Interest or "2" for Interest Only, etc.

Sidedness – Use "1" for One-Sided or "2" for Not One-Sided.

HedgingInstrumentAtFairValue – Report as a rounded whole dollar amount.

EffectivePortionOfCumulativeGainsAndLosses – Report as a rounded whole dollar amount.

ASU2017-12HedgeDesignations – Use "1" for Last-of-Layer, "2" for Selected Contractual Cash Flows, or "3" for Not Applicable.


Column descriptions file: col-desc.txt
Field No.,Field Name,Description,Allowable Values
1,Identifier Type,"Report the identifier type for an investment security. If more than one distinct qualifying hedging relationship exists for the security, please list it multiple times.","""CUSIP"", ""ISIN"", ""SEDOL"", ""Internal"""
2,Identifier Value,"Report the identifier value for an investment security. If more than one distinct qualifying hedging relationship exists for the security, please list it multiple times.","CUSIP, ISIN, SEDOL, or internal identifier value"
3,Amortized Cost (USD Equivalent),Report the amortized cost (USD equivalent) of the security being hedged.,Rounded whole dollar amount
4,Market Value (USD Equivalent),Report the market value (USD equivalent) of the security being hedged.,Rounded whole dollar amount
5,Accounting Intent,"Indicate whether the security being hedged is available-for-sale (AFS), held-to-maturity (HTM), or an equity security (EQ).","""AFS"", ""HTM"", ""EQ"""
6,Type of Hedge(s),Report the type of hedge (fair value or cash flow hedge) associated with the holding as defined by ASC 815.,"1 = Fair Value Hedge, 2 = Cash Flow Hedge"
7,Hedged Risk,"Indicate the risk being hedged, among the potential hedged risks described under ASC 815-20-25-12 and ASC 815-20-25-15.","1 = Overall Change in Fair Value or Variability in Cash Flows, 2 = Interest Rate Risk, 3 = Foreign Exchange Risk, 4 = Credit Risk, etc."
8,Hedge Interest Rate,Indicate the benchmark interest rates.,"1 = US Treasury, 2 = LIBOR, 3 = Fed Funds, 4 = Other, 5 = Not applicable"
9,Hedge Percentage,"Portion of the asset being hedged, in decimal format (0-1).","Decimal value up to 4 places, e.g., 0.8756"
10,Hedge Horizon,The latest date of the hedge effectiveness horizon.,yyyy-mm-dd format
11,Hedged Cash Flow,Indicate the cash flow type associated with the hedge.,"1 = Principal & Interest, 2 = Interest Only, etc."
12,Sidedness,Whether the hedge provides a one-sided offset.,"1 = One-sided, 2 = Not One-sided"
13,Hedging Instrument at Fair Value,USD-equivalent fair value of the hedging instrument.,"Rounded whole dollar amount (e.g., 20000000)"
14,Effective Portion of Gains/Losses,Report the effective portion of gains and losses in USD.,Rounded whole dollar amount
15,ASU 2017-12 Hedge Designations,Indicate ASU 2017-12 designations.,"1 = Last-of-Layer, 2 = Selected Contractual Cash Flows, 3 = Not Applicable"
